{
  "version": 3,
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/cloud/cloud-actions.ts"],"sourcesContent":["\"use server\";\nimport * as React from 'react';\nimport { NextRequest } from 'next/server';\nimport { cookies } from 'next/headers';\nimport PictureAsPdfOutlinedIcon from '@mui/icons-material/PictureAsPdfOutlined';\nimport FolderOutlinedIcon from '@mui/icons-material/FolderOutlined';\nimport AutoStoriesOutlinedIcon from '@mui/icons-material/AutoStoriesOutlined';\nimport TextSnippetIcon from '@mui/icons-material/TextSnippet';\nimport TextSnippetOutlinedIcon from '@mui/icons-material/TextSnippetOutlined';\nimport { imageSize as imgSz } from 'image-size';\n\nlet tabIndex = 0;\n// let tabRefFunc: (func: Function) => void;\n\nconst driveFetch = async (action: string) => {\n  const access_token = cookies().get('access_token')?.value;\n\n  return await fetch(`https:www.googleapis.com/drive/v3/${action}`, { headers: { Authorization: `Bearer ${access_token}` } })\n}\n\nconst getThumbLink: (fileId: string | undefined) => Promise<string> = async (fileId: string | undefined) => {\n  if (!fileId) return null;\n  const access_token = cookies().get('access_token')?.value;\n\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files/${fileId}?fields=thumbnailLink`, { headers: { Authorization: `Bearer ${access_token as string}` } });\n  console.log(`now fetching thumbnail link for file id ${fileId}`)\n  // const file = await fetch(req).then(res => res.json()).catch(error => console.log(`error fetching thumbnail link: ${error}`));\n  return fetch(req).then(res => { return res.json() })\n    .catch(error => console.log(new Error(error)))\n    .then(json => { return console.log(`json:`, json), json?.thumbnailLink || null })\n    .catch(error => console.log(new Error(error)));\n}\n\nconst getRootFolderId = async () => {\n  const access_token = cookies().get('access_token')?.value;\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files?trashed=false&q=mimeType+%3d+%27application/vnd.google-apps.folder%27+and+name%3d%27.OfficeMate%27&fields=files(id)`, { headers: { Authorization: `Bearer ${access_token}` } });\n\n  const res = fetch(req).then(res => { return res.json() }).then(json => {\n    console.log(json);\n    return json.files[0].id\n  });\n\n  return res;\n\n}\n\n\n\nconst getFiles = async (fields: string | null = null, query: string | null = null, pageToken: string | undefined | null = null) => {\n  const access_token = cookies().get('access_token')?.value;\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files?pageSize=1000${pageToken? `&pageToken=${pageToken}`: ''}${fields ? `&fields=${fields}`: ''}${query ? `&q=${query}`:''}` , { headers: { Authorization: `Bearer ${access_token}` } });\n\n  const res = fetch(req).then(res => { return res.json() })\n\n  return res;\n}\n\nconst getFile = async (fileId: string, fields: string | null = null) => {\n  const access_token = cookies().get('access_token')?.value;\n  // console.log(`getFile access_token:`, access_token);\n\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files/${fileId}${fields ? '?fields=' + fields : ''}`, { headers: { Authorization: `Bearer ${access_token}` } });\n  // console.log(`file request:`, req);\n  return fetch(req).then(res => res.json());\n  // const json = await res.json();\n  // console.log(`getFiles files:`, json);\n  // return json;\n}\n\nconst getFileParentIDs = async (fileId: string | undefined) => {\n  if (!fileId) return null;\n  const access_token = cookies().get('access_token')?.value;\n  const url = new URL(`https://www.googleapis.com/drive/v3/files/${fileId}?fields=parents`);\n  if (!URL.canParse(url)) return null;\n  const req = new NextRequest(url, { headers: { Authorization: `Bearer ${access_token as string}` } });\n  return fetch(req)\n    .then(res => res.json()).catch(error => { return console.log(new Error(`fileID ${fileId}: ${error}`)), null })\n    .then(json => { return Object.keys(json).length > 0 ? json.parents[0] : null })\n    .catch(error => { return console.log(new Error(error)), null });\n  // console.log(`file:`, file);\n  // return (typeof file === 'object' && Object.keys(file).length > 0) ? file.parents[0] : null;\n}\n\nconst imageSize = async (url: string) => {\n  const req = new NextRequest(url);\n  const sz = fetch(req).then(res => res.arrayBuffer()).then(ab => Buffer.from(ab)).then(buf => imgSz(buf)).then(imgSz => { return { width: imgSz.width, height: imgSz.height } });\n  return sz;\n}\n\nexport { getThumbLink, getFiles, getFileParentIDs, driveFetch, imageSize, getFile, getRootFolderId };"],"names":[],"mappings":"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"}},
    {"offset": {"line": 141, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 145, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/.next-internal/server/app/api/folderfilemap/route/actions.js"],"sourcesContent":["__turbopack_export_value__({\n  '44d5bb4b269a6af123b04f91ccdc97a2ca9b3867': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getThumbLink'])(...args)),\n  '68d54108ce72ba81a4df6a28356b67884d12da0e': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getRootFolderId'])(...args)),\n  '6f841681903f4bdcc5f605b8ee7c963a588b0b7b': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFileParentIDs'])(...args)),\n  'bc516a7b7afad84a354116b826858c24273d918a': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFile'])(...args)),\n  'c0125e8480146fc3da070f012d10bff350cec169': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['driveFetch'])(...args)),\n  'c1f40d0e1ee03146fc2edcb238f867cc63d82850': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['imageSize'])(...args)),\n  'db02d6669d1e13667cefeb97613c268ae3626593': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFiles'])(...args)),\n});"],"names":[],"mappings":"AAAA,2BAA2B;IACzB,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,eAAe,AAAD,KAAM;IAC7I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,kBAAkB,AAAD,KAAM;IAChJ,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,mBAAmB,AAAD,KAAM;IACjJ,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,UAAU,AAAD,KAAM;IACxI,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,aAAa,AAAD,KAAM;IAC3I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,YAAY,AAAD,KAAM;IAC1I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,WAAW,AAAD,KAAM;AAC3I"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/api/folderfilemap/route.ts"],"sourcesContent":["import { getFiles, getRootFolderId } from \"@/app/desktop/cloud/cloud-actions\"\nimport { NextResponse } from \"next/server\";\n\nconst getFolderFileMap = async (folderMeta = [], pageToken = null) => {\n  const rootFolderId = await getRootFolderId();\n  console.log(`rootFolderId: ${rootFolderId}`);\n\n  return await getFiles('files(name,id,mimeType,parents),nextPageToken', 'mimeType%3d%27application/vnd.google-apps.folder%27', pageToken).then(meta => {\n    const folders = [...meta.files.filter(file => Object.hasOwn(file, 'parents') && file.parents[0] === rootFolderId)]\n    // console.log(`filesMeta:`, filesMeta);\n    folderMeta = [...folderMeta, ...folders];\n    if (Object.hasOwn(meta, 'nextPageToken') && meta.nextPageToken !== pageToken) {\n      getFolderFileMap(folderMeta, meta.nextPageToken)\n    }\n    console.log(`folderMeta:`, folderMeta);\n    return folderMeta;\n  })\n    .then(folderMeta => {\n      console.log(`folderMeta:`, folderMeta);\n\n      let folderFileMap = {}\n      for (const folder of folderMeta) {\n        console.log(`folder:`, folder);\n\n        getFiles('files(id,name,mimeType,hasThumbnail,thumbnailLink,iconLink)', `%27${folder.id}%27+in+parents`).then(meta => {\n          // console.log(`files in ${folder.name}:`, meta.files);\n          folderFileMap[folder.id] = {folderName: folder.name, files:meta.files};\n          console.log(`folderFileMap:`, folderFileMap);\n\n        });\n      }\n      console.log(`folderFileMap:`, folderFileMap);\n\n      return folderFileMap;\n    })\n}\n\nconst GET = async () => {\n\n  const folderFileMap = await getFolderFileMap();\n\n  console.log(`GET route.ts folderFileMap:`, folderFileMap);\n\n  // const str = JSON.stringify(folderFileMap);\n  // console.log(`str: ${str}`);\n\n  const res = new Response(folderFileMap);\n  return res.blob();\n\n}\n\nexport { GET };"],"names":[],"mappings":";;;;;;AAGA,MAAM,mBAAmB,OAAO,aAAa,EAAE,EAAE,YAAY,IAAI;IAC/D,MAAM,eAAe,MAAM;IAC3B,QAAQ,GAAG,CAAC,CAAC,cAAc,EAAE,aAAa,CAAC;IAE3C,OAAO,MAAM,wJAAS,iDAAiD,uDAAuD,WAAW,IAAI,CAAC,CAAA;QAC5I,MAAM,UAAU;eAAI,KAAK,KAAK,CAAC,MAAM,CAAC,CAAA,OAAQ,OAAO,MAAM,CAAC,MAAM,cAAc,KAAK,OAAO,CAAC,EAAE,KAAK;SAAc;QAClH,wCAAwC;QACxC,aAAa;eAAI;eAAe;SAAQ;QACxC,IAAI,OAAO,MAAM,CAAC,MAAM,oBAAoB,KAAK,aAAa,KAAK,WAAW;YAC5E,iBAAiB,YAAY,KAAK,aAAa;QACjD;QACA,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,EAAE;QAC3B,OAAO;IACT,GACG,IAAI,CAAC,CAAA;QACJ,QAAQ,GAAG,CAAC,CAAC,WAAW,CAAC,EAAE;QAE3B,IAAI,gBAAgB,CAAC;QACrB,KAAK,MAAM,UAAU,WAAY;YAC/B,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC,EAAE;YAEvB,wJAAS,+DAA+D,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC,cAAc,CAAC,EAAE,IAAI,CAAC,CAAA;gBAC5G,uDAAuD;gBACvD,aAAa,CAAC,OAAO,EAAE,CAAC,GAAG;oBAAC,YAAY,OAAO,IAAI;oBAAE,OAAM,KAAK,KAAK;gBAAA;gBACrE,QAAQ,GAAG,CAAC,CAAC,cAAc,CAAC,EAAE;YAEhC;QACF;QACA,QAAQ,GAAG,CAAC,CAAC,cAAc,CAAC,EAAE;QAE9B,OAAO;IACT;AACJ;AAEA,MAAM,MAAM;IAEV,MAAM,gBAAgB,MAAM;IAE5B,QAAQ,GAAG,CAAC,CAAC,2BAA2B,CAAC,EAAE;IAE3C,6CAA6C;IAC7C,8BAA8B;IAE9B,MAAM,MAAM,IAAI,SAAS;IACzB,OAAO,IAAI,IAAI;AAEjB"}},
    {"offset": {"line": 209, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}