{
  "version": 3,
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/cloud/cloud-actions.ts"],"sourcesContent":["\"use server\";\nimport * as React from 'react';\nimport { NextRequest } from 'next/server';\nimport { cookies } from 'next/headers';\nimport PictureAsPdfOutlinedIcon from '@mui/icons-material/PictureAsPdfOutlined';\nimport FolderOutlinedIcon from '@mui/icons-material/FolderOutlined';\nimport AutoStoriesOutlinedIcon from '@mui/icons-material/AutoStoriesOutlined';\nimport TextSnippetIcon from '@mui/icons-material/TextSnippet';\nimport TextSnippetOutlinedIcon from '@mui/icons-material/TextSnippetOutlined';\nimport { imageSize as imgSz } from 'image-size';\n\nlet tabIndex = 0;\n// let tabRefFunc: (func: Function) => void;\n\nconst driveFetch = async (action: string) => {\n  const access_token = cookies().get('access_token')?.value;\n\n  return await fetch(`https:www.googleapis.com/drive/v3/${action}`, { headers: { Authorization: `Bearer ${access_token}` } })\n}\n\nconst getThumbLink: (fileId: string | undefined) => Promise<string> = async (fileId: string | undefined) => {\n  if (!fileId) return null;\n  const access_token = cookies().get('access_token')?.value;\n\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files/${fileId}?fields=thumbnailLink`, { headers: { Authorization: `Bearer ${access_token as string}` } });\n  console.log(`now fetching thumbnail link for file id ${fileId}`)\n  // const file = await fetch(req).then(res => res.json()).catch(error => console.log(`error fetching thumbnail link: ${error}`));\n  return fetch(req).then(res => { return res.json() })\n    .catch(error => console.log(new Error(error)))\n    .then(json => { return console.log(`json:`, json), json?.thumbnailLink || null })\n    .catch(error => console.log(new Error(error)));\n}\n\nconst getRootFolderId = async () => {\n  const access_token = cookies().get('access_token')?.value;\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files?trashed=false&q=mimeType+%3d+%27application/vnd.google-apps.folder%27+and+name%3d%27.OfficeMate%27&fields=files(id)`, { headers: { Authorization: `Bearer ${access_token}` } });\n\n  const res = fetch(req).then(res => { return res.json() }).then(json => {\n    console.log(json);\n    return json.files[0].id\n  });\n\n  return res;\n\n}\n\n\n\nconst getFiles = async (fields: string | null = null, query: string | null = null, pageToken: string | undefined | null = null) => {\n  const access_token = cookies().get('access_token')?.value;\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files?orderBy=name&pageSize=1000${pageToken ? `&pageToken=${pageToken}` : ''}${fields ? `&fields=${fields}` : ''}${query ? `&q=${query}` : ''}`, { headers: { Authorization: `Bearer ${access_token}` } });\n\n  const res = fetch(req).then(res => { return res.json() })\n\n  return res;\n}\n\nconst getFile = async (fileId: string, fields: string | null = null, query: string | null = null) => {\n  const access_token = cookies().get('access_token')?.value;\n  // console.log(`getFile access_token:`, access_token);\n\n  const req = new NextRequest(`https://www.googleapis.com/drive/v3/files/${fileId}${fields ? '?fields=' + fields : ''}${query && fields ? `&${query}` : query ? `?${query}` : ''}`, { headers: { Authorization: `Bearer ${access_token}` } });\n  // console.log(`file request:`, req);\n  return fetch(req).then(res => res.json());\n  // const json = await res.json();\n  // console.log(`getFiles files:`, json);\n  // return json;\n}\n\nconst getFileParentIDs = async (fileId: string | undefined) => {\n  if (!fileId) return null;\n  const access_token = cookies().get('access_token')?.value;\n  const url = new URL(`https://www.googleapis.com/drive/v3/files/${fileId}?fields=parents`);\n  if (!URL.canParse(url)) return null;\n  const req = new NextRequest(url, { headers: { Authorization: `Bearer ${access_token as string}` } });\n  return fetch(req)\n    .then(res => res.json()).catch(error => { return console.log(new Error(`fileID ${fileId}: ${error}`)), null })\n    .then(json => { return Object.keys(json).length > 0 ? json.parents[0] : null })\n    .catch(error => { return console.log(new Error(error)), null });\n  // console.log(`file:`, file);\n  // return (typeof file === 'object' && Object.keys(file).length > 0) ? file.parents[0] : null;\n}\n\nconst getImageSize = async (url: string | null) => {\n  if (!url) return { width: 256, height: 256 };\n  const req = new NextRequest(`${url}?alt=media`);\n  const res = await fetch(req);\n  const ab = await res.arrayBuffer();\n  const buf = Buffer.from(ab);\n  let sz = {}\n  try {\n    sz = imgSz(buf);\n  } catch (e) {\n    console.log(new Error(e));\n    return null;\n  }\n  // const sz = fetch(req).then(res => res.arrayBuffer()).then(ab => Buffer.from(ab)).then(buf => imgSz(buf)).then(imgSz => { return { width: imgSz.width, height: imgSz.height } });\n  return sz;\n}\n\nexport { getThumbLink, getFiles, getFileParentIDs, driveFetch, getImageSize, getFile, getRootFolderId };"],"names":[],"mappings":"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"}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/.next-internal/server/app/desktop/cloud/page/actions.js"],"sourcesContent":["__turbopack_export_value__({\n  '44d5bb4b269a6af123b04f91ccdc97a2ca9b3867': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getThumbLink'])(...args)),\n  '68d54108ce72ba81a4df6a28356b67884d12da0e': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getRootFolderId'])(...args)),\n  '6f841681903f4bdcc5f605b8ee7c963a588b0b7b': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFileParentIDs'])(...args)),\n  'b4b4adcd29ec984d1849c1341bb4c18a85321792': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getImageSize'])(...args)),\n  'bc516a7b7afad84a354116b826858c24273d918a': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFile'])(...args)),\n  'c0125e8480146fc3da070f012d10bff350cec169': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['driveFetch'])(...args)),\n  'db02d6669d1e13667cefeb97613c268ae3626593': (...args) => Promise.resolve(require('ACTIONS_MODULE0')).then(mod => (0, mod['getFiles'])(...args)),\n});"],"names":[],"mappings":"AAAA,2BAA2B;IACzB,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,eAAe,AAAD,KAAM;IAC7I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,kBAAkB,AAAD,KAAM;IAChJ,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,mBAAmB,AAAD,KAAM;IACjJ,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,eAAe,AAAD,KAAM;IAC7I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,UAAU,AAAD,KAAM;IACxI,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,aAAa,AAAD,KAAM;IAC3I,4CAA4C,CAAC,GAAG,OAAS,QAAQ,OAAO,CAAC,8FAA4B,IAAI,CAAC,CAAA,MAAO,AAAC,CAAA,GAAG,GAAG,CAAC,WAAW,AAAD,KAAM;AAC3I"}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 168, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/themes.tsx/proxy.ts"],"sourcesContent":["import { createProxy } from 'next/dist/build/webpack/loaders/next-flight-loader/module-proxy'\n\nconst proxy = createProxy(\"[project]/app/themes.tsx\")\n\n// Accessing the __esModule property and exporting $$typeof are required here.\n// The __esModule getter forces the proxy target to create the default export\n// and the $$typeof value is for rendering logic to determine if the module\n// is a client boundary.\nconst { __esModule, $$typeof } = proxy;\n\nexport { __esModule, $$typeof };\nexport default proxy;\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,QAAQ,0NAAY;AAE1B,8EAA8E;AAC9E,6EAA6E;AAC7E,2EAA2E;AAC3E,wBAAwB;AACxB,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG;;uCAGlB"}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/layout.tsx"],"sourcesContent":["import type { Metadata } from 'next'\nimport './globals.css'\nimport '@fontsource/roboto/300.css';\nimport '@fontsource/roboto/400.css';\nimport '@fontsource/roboto/500.css';\nimport '@fontsource/roboto/700.css';\nimport { SessionProvider } from 'next-auth/react';\nimport ThemeProvider from './themes';\n\n\nexport default function LayoutRoot({ children }) {\n  return (\n    <ThemeProvider >\n      <html>\n        <body>\n          <SessionProvider>\n            {children}\n          </SessionProvider>\n        </body>\n      </html>\n     </ThemeProvider>\n  )\n}\n\nexport const metadata: Metadata = {\n  title: 'OfficeMate',\n  description: 'Generated by create next app',\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAUe,SAAS,WAAW,EAAE,QAAQ,EAAE;IAC7C,qBACE;kBACE,cAAA,mPAAC;sBACC,cAAA,mPAAC;0BACC,cAAA;8BACG;;;;;;;;;;;;;;;;;;;;;AAMb;AAEO,MAAM,WAAqB;IAChC,OAAO;IACP,aAAa;AACf"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 258, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/main.tsx/proxy.ts"],"sourcesContent":["import { createProxy } from 'next/dist/build/webpack/loaders/next-flight-loader/module-proxy'\n\nconst proxy = createProxy(\"[project]/app/desktop/main.tsx\")\n\n// Accessing the __esModule property and exporting $$typeof are required here.\n// The __esModule getter forces the proxy target to create the default export\n// and the $$typeof value is for rendering logic to determine if the module\n// is a client boundary.\nconst { __esModule, $$typeof } = proxy;\n\nexport { __esModule, $$typeof };\nexport default proxy;\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,QAAQ,0NAAY;AAE1B,8EAA8E;AAC9E,6EAA6E;AAC7E,2EAA2E;AAC3E,wBAAwB;AACxB,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG;;uCAGlB"}},
    {"offset": {"line": 274, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 284, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/ui.tsx/proxy.ts"],"sourcesContent":["import { createProxy } from 'next/dist/build/webpack/loaders/next-flight-loader/module-proxy'\n\nconst proxy = createProxy(\"[project]/app/desktop/ui.tsx\")\n\n// Accessing the __esModule property and exporting $$typeof are required here.\n// The __esModule getter forces the proxy target to create the default export\n// and the $$typeof value is for rendering logic to determine if the module\n// is a client boundary.\nconst { __esModule, $$typeof } = proxy;\n\nexport { __esModule, $$typeof };\nexport default proxy;\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,QAAQ,0NAAY;AAE1B,8EAA8E;AAC9E,6EAA6E;AAC7E,2EAA2E;AAC3E,wBAAwB;AACxB,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG;;uCAGlB"}},
    {"offset": {"line": 305, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 310, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/layout.tsx"],"sourcesContent":["import Box from '@mui/material/Box';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport UI from './ui';\nimport Main from './main';\nimport ThemeProvider from '../themes';\n\n\nconst Layout = ({ children }: { children: React.ReactNode }) => {\n\n  return (\n    <>\n      <ThemeProvider>\n        <Box sx={{ display: 'flex' }}>\n          <CssBaseline />\n          <UI />\n          <Main>\n            {children}\n          </Main >\n        </Box>\n      </ThemeProvider>\n    </>\n  );\n}\n\nexport default Layout;"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAOA,MAAM,SAAS,CAAC,EAAE,QAAQ,EAAiC;IAEzD,qBACE;kBACE,cAAA;sBACE,cAAA;gBAAK,IAAI;oBAAE,SAAS;gBAAO;;kCACzB;;;;;kCACA;;;;;kCACA;kCACG;;;;;;;;;;;;;;;;;;AAMb;uCAEe"}},
    {"offset": {"line": 375, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 387, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/cloud/loading.tsx"],"sourcesContent":["const Loading = () => {\n  return (\n    <h1>Loading...</h1>\n  )\n}\n\nexport default Loading;"],"names":[],"mappings":";;;;;;AAAA,MAAM,UAAU;IACd,qBACE,mPAAC;kBAAG;;;;;;AAER;uCAEe"}},
    {"offset": {"line": 403, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 419, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/lib/mongodb.ts"],"sourcesContent":["\nimport { MongoClient, ServerApiVersion } from 'mongodb';\n\nconst credentials = new URL('./X509-cert-4934576125579953724.pem', import.meta.url);\n\nif (!process.env.MONGODB_URI) {\n  throw new Error('Invalid/Missing environment variable: \"MONGODB_URI\"')\n}\n\nconst uri = process.env.MONGODB_URI\nconst options = {\n  tlsCertificateKeyFile: credentials,\n  serverApi: ServerApiVersion.v1\n}\n\nlet client;\nlet clientPromise: Promise<MongoClient> | undefined;\n\nif (process.env.NODE_ENV === 'development') {\n  // In development mode, use a global variable so that the value\n  // is preserved across module reloads caused by HMR (Hot Module Replacement).\n  let globalWithMongo = global as typeof globalThis & {\n    _mongoClientPromise?: Promise<MongoClient>\n  }\n\n  if (!globalWithMongo._mongoClientPromise) {\n    client = new MongoClient(uri, options)\n    globalWithMongo._mongoClientPromise = client.connect()\n  }\n  clientPromise = globalWithMongo._mongoClientPromise\n} else {\n  // In production mode, it's best to not use a global variable.\n  client = new MongoClient(uri, options)\n  clientPromise = client.connect()\n}\n\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\nexport default clientPromise\n"],"names":[],"mappings":";;;;;;;;;;;AAGA,MAAM;AAEN,IAAI,CAAC,QAAQ,GAAG,CAAC,WAAW,EAAE;IAC5B,MAAM,IAAI,MAAM;AAClB;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,WAAW;AACnC,MAAM,UAAU;IACd,uBAAuB;IACvB,WAAW,4JAAiB,EAAE;AAChC;AAEA,IAAI;AACJ,IAAI;AAEJ,wCAA4C;IAC1C,+DAA+D;IAC/D,6EAA6E;IAC7E,IAAI,kBAAkB;IAItB,IAAI,CAAC,gBAAgB,mBAAmB,EAAE;QACxC,SAAS,2JAAgB,KAAK;QAC9B,gBAAgB,mBAAmB,GAAG,OAAO,OAAO;IACtD;IACA,gBAAgB,gBAAgB,mBAAmB;AACrD;;;uCAQe"}},
    {"offset": {"line": 454, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 459, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/cloud/folder-tabs.tsx/proxy.ts"],"sourcesContent":["import { createProxy } from 'next/dist/build/webpack/loaders/next-flight-loader/module-proxy'\n\nconst proxy = createProxy(\"[project]/app/desktop/cloud/folder-tabs.tsx\")\n\n// Accessing the __esModule property and exporting $$typeof are required here.\n// The __esModule getter forces the proxy target to create the default export\n// and the $$typeof value is for rendering logic to determine if the module\n// is a client boundary.\nconst { __esModule, $$typeof } = proxy;\n\nexport { __esModule, $$typeof };\nexport default proxy;\n"],"names":[],"mappings":";;;;;;;;AAEA,MAAM,QAAQ,0NAAY;AAE1B,8EAA8E;AAC9E,6EAA6E;AAC7E,2EAA2E;AAC3E,wBAAwB;AACxB,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,GAAG;;uCAGlB"}},
    {"offset": {"line": 475, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 480, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 485, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 490, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/auth.ts"],"sourcesContent":["import NextAuth from \"next-auth\";\nimport Google from \"next-auth/providers/google\"\nimport { cookies } from \"next/headers\";\n\nexport const {\n  handlers,\n  auth,\n  signIn,\n  signOut\n} = NextAuth({\n  debug: true,\n  callbacks: {\n    async jwt({ token, user, account, profile, session }) {\n      // const userToken = await SignToken(user?.email as string);\n      // const secret = jose.base64url.decode(process.env.NEXTAUTH_SECRET as string);\n      // const userToken = await new EncryptJWT(user?.email).setProtectedHeader({alg:'dir', enc:'A128CBC-HS256', typ:'at+JWT'}).encrypt(secret);\n      //   token.userToken = userToken;\n      return token;\n    },\n    async signIn({ account, user }) {\n\n      cookies().set('id_token', account?.id_token as string);\n      cookies().set('access_token', account?.access_token as string);\n      cookies().set('refresh_token', account?.access_token as string);\n\n    // console.log(`signIn account:`, account);\n    // access_token = account?.access_token as String;\n    // console.log(`signIn user:`, user)\n\n\n    return true // Do different verification for other providers that don't have `email_verified`\n    },\n    async session({ session, user, token }) {\n      // console.log(`session session:`, session);\n      // console.log(`token:`, token);\n      // console.log(`session user:`, user);\n      // session.loggedUser = token.userToken;\n      return session;\n    },\n    // async signIn({ user, account, profile, email, credentials }) {\n    //   console.log(`signIn user:`, user);\n    //   console.log(`signIn account:`, account);\n    //   console.log(`signIn profile:`, profile);\n    //   console.log(`signIn credentials:`, credentials);\n\n    //   return '/';\n    // },\n  },\n  // secret: process.env.NEXTAUTH_SECRET as string,\n  session: {\n    strategy: 'jwt'\n  },\n  providers: [\n    Google({\n      clientId: process.env.GOOGLE_CLIENT_ID,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n      authorization: {\n        idToken: true,\n        params: {\n          type: 'oauth',\n          scope: \"openid profile email https://www.googleapis.com/auth/drive\",\n          access_type: \"offline\",\n          prompt: \"select_account\",\n          response_type: \"code\",\n          redirect_uri: 'http://localhost:3000/api/auth/callback/google'\n        }\n      },\n    })\n  ]\n});\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAIO,MAAM,EACX,QAAQ,EACR,IAAI,EACJ,MAAM,EACN,OAAO,EACR,GAAG,wLAAS;IACX,OAAO;IACP,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;YAClD,4DAA4D;YAC5D,+EAA+E;YAC/E,0IAA0I;YAC1I,iCAAiC;YACjC,OAAO;QACT;QACA,MAAM,QAAO,EAAE,OAAO,EAAE,IAAI,EAAE;YAE5B,6IAAU,GAAG,CAAC,YAAY,SAAS;YACnC,6IAAU,GAAG,CAAC,gBAAgB,SAAS;YACvC,6IAAU,GAAG,CAAC,iBAAiB,SAAS;YAE1C,2CAA2C;YAC3C,kDAAkD;YAClD,oCAAoC;YAGpC,OAAO,KAAK,iFAAiF;;QAC7F;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,IAAI,EAAE,KAAK,EAAE;YACpC,4CAA4C;YAC5C,gCAAgC;YAChC,sCAAsC;YACtC,wCAAwC;YACxC,OAAO;QACT;IASF;IACA,iDAAiD;IACjD,SAAS;QACP,UAAU;IACZ;IACA,WAAW;QACT,iMAAO;YACL,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;YAC9C,eAAe;gBACb,SAAS;gBACT,QAAQ;oBACN,MAAM;oBACN,OAAO;oBACP,aAAa;oBACb,QAAQ;oBACR,eAAe;oBACf,cAAc;gBAChB;YACF;QACF;KACD;AACH"}},
    {"offset": {"line": 555, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 560, "column": 0}, "map": {"version":3,"sources":["/turbopack/[project]/app/desktop/cloud/page.tsx"],"sourcesContent":["import React, { Suspense, useEffect, useRef, useState } from 'react';\nimport Box from '@mui/material/Box';\nimport { auth } from '@/auth';\nimport { NextRequest } from 'next/server';\nimport { cookies } from 'next/headers';\nimport FolderTabs from './folder-tabs';\n// import { imageSize } from 'image-size';\nimport Skeleton from '@mui/material/Skeleton';\nimport { getFile, getFiles, getThumbLink, getFileParentIDs, getRootFolderId, getImageSize } from './cloud-actions';\nimport clientPromise from '@/lib/mongodb';\n\ninterface Size {\n  width: number | undefined,\n  height: number | undefined\n}\n\ninterface FileMeta {\n  name: string,\n  id: string,\n  mimeType: string,\n  parents: string[],\n  hasThumbnail: boolean,\n  thumbnailLink: string\n}\n\ninterface FileCardProps {\n  thumbLink: string | null,\n  fileName: string,\n  size: Size\n}\n\ntype FilesMeta = { name: string, id: string, mimeType: string, kind: string }\n\ntype TabFileGroups = { [id: symbol]: Promise<string>[] };\n\n\ntype FileGroup = Promise<FileCardProps>[];\n\n\nconst Page = async () => {\n\n  const session = await auth();\n\n  clientPromise?.then(client => console.log(`client:`, client));\n\n  const rootFolderId = await getRootFolderId();\n\n  // console.log(`rootFolderId: ${rootFolderId}`);\n\n  let files: FileMeta[] = [];\n  let folders: FileMeta[] = [];\n\n  const getTopLevelFolders = async (folderNames: { [id: string]: string } = {}, pageToken = null) => {\n    const rootFolderId = await getRootFolderId();\n    const folders = await getFiles('files(id,name),nextPageToken', `%27${rootFolderId}%27+in+parents+and+mimeType+contains+%27folder%27`, pageToken);\n    for (const folder of folders.files) {\n      folderNames[folder.id] = folder.name;\n    }\n    if (Object.hasOwn(folders, 'nextPageToken')) void await getTopLevelFolders(folderNames, folders.nextPageToken);\n\n    return folderNames;\n  }\n\n  const folderNames = getTopLevelFolders();\n  // console.log(`folderNames`, folderNames);\n\n  const getFolderFiles = async (folderId, files = [], pageToken: string | null = null) => {\n\n    const fs: { nextPageToken?: string | undefined, files: [] } = await getFiles('files(id,parents,name,mimeType,hasThumbnail,thumbnailLink,iconLink),nextPageToken', `%27${folderId}%27+in+parents`, pageToken);\n\n    // console.log(`fs:`, fs);\n\n    const fileIds = [];\n    // console.log()\n    for (const file of fs.files) {\n      fileIds.push(file.id);\n    }\n\n    files.push(fs);\n\n    if (Object.hasOwn(fs, 'nextPageToken')) void await getFolderFiles(folderId, files, fs.nextPageToken);\n\n    return files;\n\n  }\n\n  const getFolderFileMap = async (folderFileMap = {}) => {\n    const folderNames = await getTopLevelFolders();\n    for (const id in folderNames) {\n      // console.log(`folder ID:`, id);\n      const files = await getFolderFiles(id);\n      folderFileMap[id] = {folderName:folderNames[id],files: [...files[0].files]};\n    }\n    // console.log(`folderFileMap:`, folderFileMap);\n\n    return folderFileMap;\n  }\n\n  const folderFileMap = getFolderFileMap();\n  // console.log(`folderFileMap:`, folderFileMap);\n\n  \n  const getImageSizes = async () => {\n    const map = await folderFileMap;\n    const imageSizes = {};\n    for (const folderId in map) {\n      console.log(`map[${folderId}]:`, map[folderId]);\n      for(const file of map[folderId].files) {\n        imageSizes[file.id] = getImageSize(file.thumbnailLink);\n      }\n    }\n    console.log(`imagSizes:`, imageSizes);\n\n    return imageSizes;\n  }\n  const imageSizes = getImageSizes();\n  console.log(`imageSizes:`, imageSizes);\n\n  const getFileNames = async (fileNames: { [id: string]: string } = {}, pageToken = null) => {\n\n    const files = await getFiles('files(id,name),nextPageToken', null, pageToken);\n    // console.log(`files:`, files);\n    for (const file of files.files) {\n      fileNames[file.id] = file.name;\n    }\n    if (Object.hasOwn(files, 'nextPageToken')) void await getFileNames(fileNames, files.nextPageToken);\n\n    return fileNames;\n\n  }\n\n  let fileNames = {}\n\n  // fileNames = getFileNames();\n  // console.log(`fileNames:`, fileNames);\n\n  return (\n    <Box component='main' sx={{ width: '100%', height: '100%' }}>\n      <Suspense fallback={<Skeleton variant='rounded' width='100%' height='100%' />} >\n        <FolderTabs {...{ folderNames, folderFileMap, imageSizes }} />\n      </Suspense>\n    </Box>\n  );\n\n}\n\nexport default Page;"],"names":[],"mappings":"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"}},
    {"offset": {"line": 690, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}